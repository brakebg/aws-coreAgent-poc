{
  "openapi": "3.0.0",
  "info": {
    "title": "Cost Explorer Tool API",
    "version": "1.0.0",
    "description": "API for querying AWS cost data, forecasts, and anomalies"
  },
  "paths": {
    "/get_cost_and_usage": {
      "get": {
        "summary": "Get cost and usage data",
        "description": "Retrieves AWS cost and usage data for a specified time period, grouped by a dimension like SERVICE or REGION.",
        "operationId": "getCostAndUsage",
        "parameters": [
          {
            "name": "start_date",
            "in": "query",
            "description": "Start date in YYYY-MM-DD format. Defaults to first day of current month.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date"
            },
            "example": "2025-12-01"
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "End date in YYYY-MM-DD format. Defaults to today.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date"
            },
            "example": "2025-12-28"
          },
          {
            "name": "group_by",
            "in": "query",
            "description": "Dimension to group costs by. Options: SERVICE, REGION, INSTANCE_TYPE. Defaults to SERVICE.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": ["SERVICE", "REGION", "INSTANCE_TYPE"]
            },
            "example": "SERVICE"
          },
          {
            "name": "granularity",
            "in": "query",
            "description": "Time granularity for results. Options: DAILY, MONTHLY. Defaults to MONTHLY.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": ["DAILY", "MONTHLY"]
            },
            "example": "MONTHLY"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with cost data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "start_date": {"type": "string"},
                    "end_date": {"type": "string"},
                    "group_by": {"type": "string"},
                    "granularity": {"type": "string"},
                    "total": {"type": "string"},
                    "breakdown": {"type": "array", "items": {"type": "object"}}
                  }
                },
                "example": {
                  "start_date": "2025-12-01",
                  "end_date": "2025-12-28",
                  "group_by": "SERVICE",
                  "granularity": "MONTHLY",
                  "total": "$234.56",
                  "breakdown": [
                    {"period": "2025-12-01 to 2025-12-28", "service": "Amazon EC2", "amount": "$142.30"},
                    {"period": "2025-12-01 to 2025-12-28", "service": "Amazon RDS", "amount": "$52.10"},
                    {"period": "2025-12-01 to 2025-12-28", "service": "Amazon S3", "amount": "$23.45"}
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/get_cost_forecast": {
      "get": {
        "summary": "Get cost forecast",
        "description": "Retrieves predicted AWS costs for a future time period based on historical usage patterns.",
        "operationId": "getCostForecast",
        "parameters": [
          {
            "name": "start_date",
            "in": "query",
            "description": "Forecast start date in YYYY-MM-DD format. Defaults to tomorrow.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date"
            },
            "example": "2025-12-29"
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "Forecast end date in YYYY-MM-DD format. Defaults to end of next month.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date"
            },
            "example": "2026-01-31"
          },
          {
            "name": "granularity",
            "in": "query",
            "description": "Time granularity for forecast. Options: DAILY, MONTHLY. Defaults to MONTHLY.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": ["DAILY", "MONTHLY"]
            },
            "example": "MONTHLY"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with forecast data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "forecast_period": {"type": "string"},
                    "granularity": {"type": "string"},
                    "total_forecast": {"type": "string"},
                    "breakdown": {"type": "array", "items": {"type": "object"}}
                  }
                },
                "example": {
                  "forecast_period": "2025-12-29 to 2026-01-31",
                  "granularity": "MONTHLY",
                  "total_forecast": "$267.00",
                  "breakdown": [
                    {"period": "2025-12-01 to 2026-01-01", "mean": "$133.50", "low": "$120.00", "high": "$150.00"},
                    {"period": "2026-01-01 to 2026-02-01", "mean": "$133.50", "low": "$115.00", "high": "$155.00"}
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/get_anomalies": {
      "get": {
        "summary": "Get cost anomalies",
        "description": "Retrieves ML-detected cost anomalies from AWS Cost Anomaly Detection service.",
        "operationId": "getAnomalies",
        "parameters": [
          {
            "name": "lookback_days",
            "in": "query",
            "description": "Number of days to look back for anomalies. Maximum 90 days. Defaults to 30.",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 90
            },
            "example": 30
          },
          {
            "name": "monitor_arn",
            "in": "query",
            "description": "ARN of the anomaly monitor to query. Defaults to first available monitor.",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with anomaly data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "lookback_period": {"type": "string"},
                    "monitor_arn": {"type": "string"},
                    "anomaly_count": {"type": "integer"},
                    "anomalies": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "anomaly_id": {"type": "string"},
                          "start_date": {"type": "string"},
                          "end_date": {"type": "string"},
                          "dimension": {"type": "string"},
                          "expected_spend": {"type": "string"},
                          "actual_spend": {"type": "string"},
                          "impact": {"type": "string"},
                          "impact_percentage": {"type": "string"},
                          "root_causes": {"type": "array", "items": {"type": "object"}}
                        }
                      }
                    }
                  }
                },
                "example": {
                  "lookback_period": "2025-11-28 to 2025-12-28",
                  "monitor_arn": "arn:aws:ce::123456789012:anomalymonitor/abc123",
                  "anomaly_count": 1,
                  "anomalies": [
                    {
                      "anomaly_id": "abc123",
                      "start_date": "2025-12-20",
                      "end_date": "2025-12-21",
                      "dimension": "Amazon EC2",
                      "expected_spend": "$67.00",
                      "actual_spend": "$185.00",
                      "impact": "$118.00",
                      "impact_percentage": "176.1%",
                      "root_causes": [
                        {"service": "Amazon EC2", "region": "us-east-1", "usage_type": "BoxUsage:c5.4xlarge"}
                      ]
                    }
                  ]
                }
              }
            }
          }
        }
      }
    }
  }
}
